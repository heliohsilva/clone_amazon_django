{% include './header.html' %}
{% include './navbar.html' %}

<style>
    .product-section {
        display: flex;
        gap: 40px;
        margin-top: 40px;
        background-color: #fff;
        padding: 40px;
        border-radius: 8px;
    }

    .product-image {
        flex-basis: 50%;
        text-align: center;
    }

    .product-image img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        border: 1px solid #e0e0e0;
    }

    .product-image .image-title {
        margin-top: 10px;
        font-weight: 600;
    }

    .product-details {
        flex-basis: 50%;
    }

    .product-price {
        font-size: 36px;
        font-weight: 700;
        color: #000;
    }

    .rating-stock {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 10px 0;
        padding: 10px;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
    }

    .rating-stock .stars {
        color: #f5b942;
    }

    .rating-stock .stock-status {
        font-weight: 600;
        color: #28a745;
    }

    .product-description h3 {
        margin-top: 20px;
        font-size: 20px;
    }

    .product-description p {
        line-height: 1.6;
        color: #555;
    }

    .quantity-selector {
        display: flex;
        align-items: center;
        margin: 20px 0;
    }

    .quantity-selector button {
        background-color: #f1f1f1;
        border: 1px solid #e0e0e0;
        padding: 10px 15px;
        cursor: pointer;
        font-size: 18px;
    }

    .quantity-selector input {
        width: 50px;
        text-align: center;
        border: 1px solid #e0e0e0;
        border-left: none;
        border-right: none;
        padding: 10px 0;
        font-size: 16px;
    }

    .buy-button {
        width: 100%;
        padding: 15px;
        background-color: #000;
        color: #fff;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        font-weight: 700;
        cursor: pointer;
        text-align: center;
        text-transform: uppercase;
    }

    /* Reviews Section */
    .reviews-section {
        margin-top: 40px;
        background-color: #fff;
        padding: 40px;
        border-radius: 8px;
    }

    .reviews-section h2 {
        font-size: 24px;
        margin-bottom: 30px;
    }

    .review-form,
    .review-card {
        display: flex;
        gap: 20px;
        margin-bottom: 30px;
    }

    .user-avatar {
        font-size: 32px;
        color: #ccc;
    }

    .review-content {
        flex-grow: 1;

    }

    .review-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 5px;
    }

    .reviewer-name {
        font-weight: 600;
    }

    .review-rating {
        color: #f5b942;
    }

    .review-text {
        color: #555;
        line-height: 1.5;
        background-color: #fff;
    }

    .review-form textarea {
        width: 100%;
        height: 80px;
        padding: 10px;
        border: 1px solid #e0e0e0;
        border-radius: 5px;
        resize: vertical;
        margin-top: 10px;
    }

    .publish-review-btn {
        display: block;
        margin-left: auto;
        padding: 12px 25px;
        background-color: #000;
        color: #fff;
        border: none;
        border-radius: 5px;
        font-weight: 600;
        cursor: pointer;
        text-transform: uppercase;
    }
</style>

<main class="container">
    <section class="product-section">
        <div class="product-image">
            {% if produto.imagem %}
            <img src="{{ produto.imagem.url }}" alt="{{ produto.nome }}">
            {% endif %}
        </div>

        <div class="product-details">
            <h1>{{ produto.nome }}</h1>
            <h1 class="product-price">$ {{ produto.preco|floatformat:2 }}</h1>

            <div class="rating-stock">
                <div>
                    <span class="stars">
                        {% for i in range_rate %}
                        <i class="fas fa-star fa-solid"></i>
                        {% endfor %}
                        {% for i in range_void %}
                        <i class="fa-regular fa-star"></i>
                        {% endfor %}
                    </span>
                    <span style="font-weight: 600;">{{ produto.star_rating }}</span>
                    <a href="#reviews" style="font-size: 14px; margin-left: 10px; color: #555;">
                        {{produto.count_reviews}} avaliações
                    </a>
                </div>
                {% if produto.em_estoque %}
                <span class="stock-status">Em Estoque</span>
                {% else %}
                <span class="stock-status" style="color: #dc3545;">Fora de Estoque</span>
                {% endif %}
            </div>

            <div class="product-description">
                <h3>Descrição</h3>
                <p>{{ produto.descricao }}</p>
            </div>

            <div class="quantity-selector">
                <button>-</button>
                <input type="text" value="1">
                <button>+</button>
            </div>
            <a href="{% url 'adicionar_ao_carrinho' produto.id %}" class="buy-link">
                <button class="buy-button">Comprar</button>
            </a>
        </div>
    </section>

    <section id="reviews" class="reviews-section">
        <h2>REVIEWS</h2>

        <form action="{% url 'adicionar_comentario' produto.id %}" method="post" class="review-form">
            {% csrf_token %}
            <div class="user-avatar">
                <i class="fas fa-user-circle"></i>
            </div>
            <div class="review-content">
                <div class="review-header">
                    <span class="reviewer-name">{{ cliente.nome|default:'Seu Usuário' }}</span>

                </div>
                <textarea name="texto" placeholder="Escreva aqui sua avaliação deste produto..."></textarea>
                <br>
                <br>
                <label for="nota">Avaliação:</label>
                <input type="number" name="nota" id="nota" min="1" max="5" value="5"
                    style="width: 60px; margin-left: 10px;">
                <button type="submit" class="publish-review-btn">Publicar Review</button>
            </div>
        </form>

        <br>

        {% for comentario in comentarios %}
        <div class="review-card">
            <div class="user-avatar">
                <i class="fas fa-user-circle"></i>
            </div>
            <div class="review-content">
                <div class="review-header">
                    <span class="reviewer-name">{{ comentario.cliente.nome }}</span>
                    <span class="review-rating">
                        <i class="fas fa-star"></i> {{ comentario.nota }}/5
                    </span>
                </div>
                <div class="review-text">
                    <p>{{ comentario.comentario }}</p>
                </div>
            </div>
        </div>
        {% empty %}
        <p>Ainda não há avaliações para este produto. Seja o primeiro a avaliar!</p>
        {% endfor %}
    </section>
</main>

</body>

</html>